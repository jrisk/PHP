<!DOCTYPE>
<html>
<head>
<title>get Image Data</title>
</head>
<body>
<canvas id='mycanvas' width='2000' height='2000'>HELLO</canvas>
<script>
canvas = document.getElementById('mycanvas')
context = canvas.getContext('2d')

thepic = new Image()
thepic.src = 'doghat.jpg'

thepic.onload = function()
{
	context.drawImage(thepic, 0, 0)
	idata = context.getImageData(0, 0, thepic.width, thepic.height)
	
	for (y = 0; y < thepic.height; ++y)
	{
		pos = y * thepic.width * 4
		
		for (x = 0; x < thepic.width; ++x)
		    {      
			average =      
			(        idata.data[pos]     +        idata.data[pos + 1] +        idata.data[pos + 2]      ) / 3
      idata.data[pos]     = average + 50      
	  idata.data[pos + 1] = average      
	  idata.data[pos + 2] = average - 50     
	  pos += 4;    }  
	  }  
	  context.putImageData(idata, 320, 0) 
	  }
</script>
</body>
</html>